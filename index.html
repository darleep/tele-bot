<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootswatch/4.5.2/darkly/bootstrap.min.css">
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"
    ></script>
    
  </style>
    <title>Form</title>
  </head>
  <body>
    <div class="container mt-5">
      <form id="myForm">
        <div class="form-group">
          <label for="name">Name</label>
          <input
            type="text"
            class="form-control"
            id="name"
            name="name"
            required
          />
        </div>
        <div class="form-group">
          <label for="city">City</label>
          <input
            type="text"
            class="form-control"
            id="city"
            name="city"
            required
          />
           <div class="form-group">
          <label for="area">Area</label>
          <input
            type="text"
            class="form-control"
            id="Area"
            name="area"
            required
          />
        </div>
        <div class="form-group">
          <label for="number">Number</label>
          <input
            type="text"
            pattern="[0-9]{10}"
            class="form-control"
            id="number"
            name="number"
            required
          />
        </div>
        <div class="form-group">
          <label for="roll"></label>
          <input
            type="hidden"
            class="form-control"
            id="roll"
            name="roll"
            required
          />
          
          <div id="reviewForm" style="display: none;">
           <h3>Please Review Your Information</h3>
           <p><strong>Name:</strong> <span id="reviewName"></span></p>
           <p><strong>City:</strong> <span id="reviewCity"></span></p>
           <p><strong>Area:</strong> <span id="reviewArea"></span></p>
           <p><strong>Number:</strong> <span id="reviewNumber"></span></p>
           <button id="submitBtn" class="btn btn-primary">Submit</button>
           <button id="editBtn" class="btn btn-secondary">Edit</button>
            </div>
          
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>

    <div id="result"></div>

      
<script>
// generate unique roll number
document.getElementById("roll").value = Math.floor(Math.random() * 1000000);

// submit form data to Google Sheet
const form = document.getElementById("myForm");
const reviewForm = document.getElementById("reviewForm");

form.addEventListener("submit", e => {
  e.preventDefault();
  const name = form.elements.name.value;
  const city = form.elements.city.value;
  const area = form.elements.area.value;
  const roll = form.elements.roll.value;
  const number = form.elements.number.value;
  
  // populate review form with user input
  document.getElementById("reviewName").textContent = name;
  document.getElementById("reviewCity").textContent = city;
  document.getElementById("reviewArea").textContent = area;
  document.getElementById("reviewNumber").textContent = number;

  // hide myForm and show reviewForm
  myForm.style.display = "none";
  reviewForm.style.display = "block";
});

  const url = 'https://script.google.com/macros/s/AKfycbz5Lmy-C_XglAcTtKLARNFZ0Gj1kOPYABhsvqPTZpcd-Bl7vs9ZZsirELt8lKvnjHoH/exec';
  const params = `?name=${name}&city=${city}&area=${area}&number=${number}&roll=${roll}`;
  
  fetch(url + params, { method: "GET" })
    .then(response => {
      console.log("Success");
      // show success message
      window.history.replaceState({}, "", `?roll=${roll}`);
      document.getElementById("myForm").style.display = "none";
      document.getElementById("result").innerHTML = "<h3 class='text-center'>Your Roll No. is " + roll + "</h3>";
    })
    .catch(error => console.error("Error:", error));
;
</script>
